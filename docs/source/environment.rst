Модули и глобальные функции
===========================

Модули
------

Модуль — это некоторый код или скрипт, который может состоять из набора операторов и определений функций, сохраненный в виде отдельного файла. Все, что модуль экспортирует, будь то функции, переменные или таблицы, LUA определяет внутри этого модуля, который выступает в качестве локального пространства имен.
В Renga скрипты, описывающие оборудование, создаются в следующих модулях:

.. attention:: Меняется

+------------------+---------------------------------------------------------------------------------+
| Модуль           | Содержание                                                                      |
+==================+=================================================================================+
| global.lua       | Функции и глобальные переменные, которые могут использоваться в других модулях  |
+------------------+---------------------------------------------------------------------------------+
| parameters.lua   | Функции, управляющие видимостью параметров                                      |
+------------------+---------------------------------------------------------------------------------+
| geometry.lua     | Функции, создающие 3D объём оборудования                                        |
+------------------+---------------------------------------------------------------------------------+
| symbolic.lua     | Функции, создающие условное изображение оборудования                            |
+------------------+---------------------------------------------------------------------------------+
| conventional.lua | Функции, создающие символьное изображение оборудования                          |
+------------------+---------------------------------------------------------------------------------+
| connectors.lua   | Функции, создающие порты к оборудованию                                         |
+------------------+---------------------------------------------------------------------------------+

Переменные и функции (модуля `global.lua`), которые будут использованы в других модулях объявляются с помощью ключевого слова ``global``. Их вызов в других модулях выполняется как ``global.<имя_функции_или_переменной>``.

Переменные и функции, которые создаются и используются в одном модуле, объявляются с помощью ключевого слова ``local``.

Пример:

.. code-block:: console
    :caption: Создание глобальной переменной в модуле global.lua:

    global flange_thickness = 1.5

.. code-block:: console
    :caption: Использование глобальной переменной в конструкторе 3D тела в модуле geometry.lua:

    local solid = ExtrusionWithThickness(contour, height, global.flange_thickness)

Глобальные функции
------------------

Глобальные функции не требуют объявления. Их можно просто вызвать в соответствующем модуле.

* Создать 3D тело (в модуле *geometry.lua*)

.. function:: renga.geometry.detailed.add_solid(*args)

    :param args: В качестве аргументов передаются 3D тела.
    :type args: :doc:`3D тела <../geometry>`

* Создать условное изображение (в модуле *symbolic.lua*)

.. function:: renga.geometry.symbolic.add_planar_geometry(*args)

    :param args: В качестве аргументов передается плоская геометрия.
    :type args: :doc:`PlanarGeometry <../planar>`

* Создать символьное изображение (в модуле *conventional.lua*)

.. function:: renga.geometry.symbol.add_planar_geometry(*args)

    :param args: В качестве аргументов передается плоская геометрия.
    :type args: :doc:`PlanarGeometry <../planar>`

* Создать вспомогательную 3D геометрию

.. function:: renga.geometry.aux.detailed.add_solid(*args)

* Создать точку подключения (порт) оборудования (в модуле *connectors.lua*)

.. function:: renga.add_connector(port)

    :param port: Задается порт.
    :type port: :doc:`Port <../ports>`

* Задать видимость параметра (в модуле *parameters.lua*)

.. function:: renga.set_param_visible(parameter, bool)

    :param parameter: Задает идентификатор (имя) параметра.
    :param bool: Задает видимость параметра. True - видимый, False - невидимый
    :type bool: boolean